# AKI Service

АКИ сервис включает в себя реализацию бизнес логики, а также сервис REST API.

База данных `postgres`. В качестве инструмента миграций используется `goose`.

Компиляция и развертка происходит в контейнере `docker`. Затем готовый образ разворачивается на сервере.


## Конфигурация

В качестве конфигураций запуска используются переменные среды и `yaml` файл.


### Envs

Для конфигурации сервера используются следующие переменные среды:

 * `HTTP_ADDR` - IP адрес сервера для прослушивания. 
 * `HTTP_PORT` - порт сервера для прослушивания.
 * `PG_DSN` - `DSN` строка для подключения к базе данных `postgres`. Пример,
`postgres://user:password@postgres/aki?sslmode=disable`
 * `CONFIG_YAML` - путь до файла конфигураций `yaml`.


### Файл конфигураций YAML

В качестве параметров конфигурации в файле конфигураций `yaml` используются следующие значения:

 * `api_version` - версия апи, используется для генерации урлов `api/v${api_version}` и `pub/v${api_version}`
 * `allow_origins` - список адресов, с которых разрешено получать доступ к ресурсам он же `Access-Control-Allow-Origin`.
 * `login_url` - путь до страницы авторизации, для редиректа неавторизованных пользователей. Пример, `auth/login`.


## REST API

`REST API` реализован на фреймворке `echo`.

В качестве групп маршрутов используются следующие префиксы:

 * `api/v1` - префикс приватных маршрутов, для которых необходима авторизация. Для ролевой модели хотели использовать
группы, но не успели(.
 * `pub/v1` - префикс публичных маршрутов, к ним относятся поиск, вывод площадок, фильтры, авторизация, регистрация и т.д.


## Что не реализовано

Не реализовано, но планировалось:

 * Авторизация JWT
 * Поэтапная регистрация пользователей: при регистрации необходимо указать минимальный набор обязательных данных из 
Датасета, а также кем является регистрируемый - арендатором или арендодателем. В случае арендодателя, после успешной
регистрации, редирект на страницу ввода детальной информации об юридическом лице арендодателя.
 * Добавление объектов аренды: объект аренды - конкретное место на креативном пространстве, например, офис, коворкинг, 
дизайн студия и т.д.
 * Вывод и поиск площадок: для удобства, планировалось делать поиск по ключевым словам, которые можно было
бы генерировать из фраз названий площадок и объектов, а также их описаний.
 * Фильтры поиска площадок:
   * Имя объекта, площадки и т.д. (гибкое название поискового объекта)
   * Максимальная сумма бронирования
   * Даты бронирования
   * Минимальное время бронирования объекта площадки
   * Требуемое время бронирования площадки